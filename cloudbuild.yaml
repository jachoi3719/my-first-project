steps:
  # Docker Build (버전 태그 추가)
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', '-t', 'asia-northeast1-docker.pkg.dev/${PROJECT_ID}/my-docker-repo/myimage:v2', '.']

  # Docker Push
  - name: 'gcr.io/cloud-builders/docker'
    args: ['push', 'asia-northeast1-docker.pkg.dev/${PROJECT_ID}/my-docker-repo/myimage:v2']

  # Entrypoint, timeout and environment variables (이미지 태그 변경)
  - name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
    entrypoint: 'gcloud'
    timeout: 240s
    args: ['compute', 'instances', 'create-with-container', 'my-vm-name',
          '--container-image', 'asia-northeast1-docker.pkg.dev/${PROJECT_ID}/my-docker-repo/myimage:v2']
    env:
      - 'CLOUDSDK_COMPUTE_REGION=asia-northeast1'
      - 'CLOUDSDK_COMPUTE_ZONE=asia-northeast1-a'
